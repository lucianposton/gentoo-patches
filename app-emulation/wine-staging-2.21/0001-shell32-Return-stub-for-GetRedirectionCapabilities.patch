From 349064216a606c9c16be05da71ab5923a63d7c79 Mon Sep 17 00:00:00 2001
From: Lucian Poston <lucian.poston@gmail.com>
Date: Wed, 22 Nov 2017 12:20:46 -0800
Subject: [PATCH] shell32: Stub GetRedirectionCapabilities with S_OK.

Signed-off-by: Lucian Poston <lucian.poston@gmail.com>
Signed-off-by: Alexandre Julliard <julliard@winehq.org>
---
 dlls/shell32/shellpath.c       | 6 ++++--
 dlls/shell32/tests/shellpath.c | 1 -
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/dlls/shell32/shellpath.c b/dlls/shell32/shellpath.c
index c5ba6295cd..4f1cdc01b2 100644
--- a/dlls/shell32/shellpath.c
+++ b/dlls/shell32/shellpath.c
@@ -5555,8 +5555,10 @@ static HRESULT WINAPI knownfolder_GetRedirectionCapabilities(
     IKnownFolder *iface,
     KF_REDIRECTION_CAPABILITIES *pCapabilities)
 {
-    FIXME("%p\n", pCapabilities);
-    return E_NOTIMPL;
+    FIXME("%p stub\n", pCapabilities);
+    if(!pCapabilities) return E_INVALIDARG;
+    *pCapabilities = KF_REDIRECTION_CAPABILITIES_DENY_ALL;
+    return S_OK;
 }
 
 static HRESULT WINAPI knownfolder_GetFolderDefinition(
diff --git a/dlls/shell32/tests/shellpath.c b/dlls/shell32/tests/shellpath.c
index 9fea876e8b..387eecbd3e 100644
--- a/dlls/shell32/tests/shellpath.c
+++ b/dlls/shell32/tests/shellpath.c
@@ -2121,7 +2121,6 @@ static void test_knownFolders(void)
             CoTaskMemFree(folderPath);
 
             hr = IKnownFolder_GetRedirectionCapabilities(folder, &redirectionCapabilities);
-            todo_wine
             ok(hr == S_OK, "failed to get redirection capabilities: 0x%08x\n", hr);
             todo_wine
             ok(redirectionCapabilities==0, "invalid redirection capabilities returned: %d\n", redirectionCapabilities);
-- 
2.13.6

